\subsubsection{Anchor boxes}

Анкерные или якорные рамки (anchor boxes) впервые были предложены в архитектуре Faster RCNN и затем получили свое распространение на многие современные архитектуры детекторов таких как YOLO или RetinaNet. 

Предположим, что СНС сворачивает исходное изображение до тензора размерности $3 \times 3$. Таким образом, в каждом супер-пикселе выходного тензора содержится информация о некоторой области исходного изображения. Тогда можно предположить размеры объекта, попадающего в такой супер-пиксель (рис. \ref{anchor-boxes}). Эти размеры, их количество и ориентация и называются анкерными рамками (т.е. рамками "привязанными" к супер-пикселю). Для RetinaNet каждый супер-пиксель имеет анкоры с соотношениями сторон $2:1, 1:1, 1:2$ и размерами $2^0, 2^{\frac{1}{3}}, 2^{\frac{2}{3}}$ (и того 9 штук). При обучении модели для каждого объекта подбираются в наиболее подходящие анкеры. Если $IoU$ рамки больше 0.5, то она считается верной, а если меньше 0.4 -- ложной. В случаях когда $IoU \in [0.4 .. 05]$ anchor box будет проигнорирован для обучения.

\addimghere{5-3-anchor-boxes}{0.6}{Аnchor boxes}{anchor-boxes}