\section{Устройство RetinaNet}\label{sect-5}

Архитектура RetinaNet, взятая за основу для моего исследования, состоит из ряда основных частей. Каждая из них выполняет определенную функцию:
\begin{itemize}
    \item backbone (или базовая сеть) -- необходима для извлечения тензора признаков (feature extraction) из входного изображения. В качестве нее может быть выбран один из нескольких вариантов СНС таких как: ResNet, EfficientNet, MobileNet и прочие;
    \item Feature Pyramid Network (FPN) -- пирамидальная СНС, необходима для трансформации признаков \cite{lib-fpn}. Она объединяет карты признаков приходящих как с верхних, так и с нижних уровней базовой СНС, так как первые обладают низкой обобщающей способностью (receptive field) при большей размерности, а последние -- наоборот;
    \item Classification Subnet Network (подсеть классификации) -- необходима для извлечения информации о классах. Классификация происходит для каждого уровня пирамиды, затем результаты фильтруются;
    \item Regression Subnet Network (подсеть регрессии) -- необходима для извлечения информации о положении объекта. Регрессия также происходит для каждого уровня пирамиды, затем результаты фильтруются;
    \item Блок пост обработки -- представляет собой набор алгоритмов для фильтрации предсказаний СНС. Как правило, здесь применяются такой алгоритм как NMS (Non Maximum Suppression) \cite{lib-nms}.
\end{itemize}

Ниже приведена общая архитектурная схема RetinaNet:

\addimghere{5-retinanet-architecture}{1}{Архитектурная схема RetinaNet}{retinanet-architecture}

Рассмотрим каждую из частей RetinaNet подробнее.

\input{inc/5-1-backbone}
\input{inc/5-2-fpn}
\input{inc/5-3-anchor-boxes}
\input{inc/5-4-classification-and-regression-subsets}
\input{inc/5-5-loss-function}
\input{inc/5-6-nms}

\clearpage