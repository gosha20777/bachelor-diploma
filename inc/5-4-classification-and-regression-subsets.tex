\subsection{Подсети классификации и регрессии}

Classification и regression subnet получают на вход признаки из нисходящей пирамиды FPN и выдают предсказания о классе и местоположении объекта. 

В подсети классификации сигнал сперва проходит через 4 сверточных слоя с размерностью $[3 \times 3]$, с 256 фильтрами и со стоящей после ReLU активацией. Таким образом, в каждом convolution слое формируется тензор размера $[h \times W \times 256]$ (256 карт признаков). Затем, сигнал снова проходит через сверточный слой $[3 \times 3]$, но уже с $K \times A$ фильтрами и сигмоидальной активацией. В результате, на выходе этой сети формируется вектор длиной $K \times A$, где $K$ -- количество разных классов (в нашем случае только один класс -- это Pedestrian), $A$ -- количество анкерных рамок. Подсеть для каждого анкера выдает one-hot вектор, где позиция числа 1 соответствует номеру класса для каждого анкера к которому модель отнесла объект.

В подсети регрессии первые 4 слоя эквивалентны соответствующим слоям в classification subnet. Затем, идет свертка,  $[3 \times 3]$ формирующая $4 \times A$ карт признаков. После чего, аналогично классификационной подсети, формируется вектор длинны $4 \times A$. Таким образом, подсеть позволяет уточнить 4-компонентный вектор координат анкера под реальный размер объекта: $(\Delta x_{min}, \Delta y_{min}, \Delta x_{max}, \Delta y_{max})$.